{"version":3,"file":"main.min.js","sources":["../src/utils/data/class.ts","../src/utils/v3/user-position.ts"],"sourcesContent":["import type { ClassType } from '@zvms/zvms4-types'\nimport dayjs from 'dayjs'\n\ninterface Class {\n  type: 'Z' | 'J'\n  grade: number\n  class: number\n  year: number\n}\n\nexport function getUserGrade(year: number) {\n  const y = dayjs().year()\n  return y - year + (dayjs().month() < 8 ? 0 : 1)\n}\n\nexport function getUserClass(id: number, code?: number) {\n  const classinfo = code ? getUserClassByCode(code) : getUserClassByNumber(id)\n  const grade = getUserGrade(classinfo.year)\n  return {\n    type: classinfo.type,\n    grade,\n    class: classinfo.class,\n    year: classinfo.year\n  } as ClassType\n}\n\nexport function getUserClassByNumber(id: number) {\n  const classid = Math.floor((id % 10000) / 100)\n  const type = classid > 10 ? 'J' : 'Z'\n  const classord = classid % 10\n  const year = Math.floor(id / 10000)\n  const grade = getUserGrade(year)\n  return {\n    type,\n    year,\n    grade,\n    class: classord\n  } as Class\n}\n\nexport function getUserClassByCode(code: number): Class {\n  const year = Math.floor((code % 1000000) / 10000) + 2000\n  const grade = getUserGrade(year)\n  const classid = Math.floor((code % 10000) / 100)\n  if (code.toString(8).startsWith('09')) {\n    return {\n      type: classid <= 8 ? 'Z' : 'J',\n      year,\n      grade,\n      class: classid <= 8 ? classid : classid - 8\n    }\n  } else if (code.toString(8).startsWith('39')) {\n    return {\n      type: classid <= 2 ? 'Z' : 'J',\n      year,\n      grade,\n      class: classid <= 2 ? classid : classid - 2\n    }\n  } else {\n    return {\n      type: 'Z',\n      year,\n      grade: 0,\n      class: classid\n    }\n  }\n}\n\nexport function getClassName(classType: Class) {\n  const title = classType.type === 'J' ? '蛟' : '高'\n  const grades = ['一', '二', '三']\n  if (classType.grade === 0) return '未知班级'\n  if (classType.class === 0) return `${classType.year} 级`\n  if (classType.grade > 3)\n    return `${classType.year} 级 ${\n      classType.class > 10 ? `蛟 ${classType.class - 10}` : `${classType.class}`\n    } 班`\n  const grade = grades[classType.grade - 1]\n  return `${title}${grade}（${classType.class % 10}）班`\n}\n\nexport function getUserClassName(id: number, code?: number) {\n  return getClassName(getUserClass(id, code))\n}\n","import type { UserPosition } from '@zvms/zvms4-types'\n\nexport function getUserPosition(permission: number) {\n  /**\n   * 1. Student - 0\n   * 2. Secretary - 1\n   * 3. Auditor - 2\n   * 4. Department - 4\n   * 4. Inspector - 8\n   * 5. Admin - 16\n   * 6. System - 32\n   * Stackable, Unique\n   */\n  const isStudent = true\n  const isSecretary = permission & 1\n  const isDepartment = permission & 2\n  const isAutidor = permission & 4\n  const isInspector = permission & 8\n  const isAdmin = permission & 16\n  const isSystem = permission & 32\n  console.log(\n    isStudent,\n    isSecretary,\n    isDepartment,\n    isAutidor,\n    isInspector,\n    isAdmin,\n    isSystem,\n    permission\n  )\n  return ['student', 'secretary', 'department', 'auditor', 'inspector', 'admin', 'system'].filter(\n    (_, i) => [isStudent, isSecretary, isDepartment, isAutidor, isInspector, isAdmin, isSystem][i]\n  ) as UserPosition[]\n}\n"],"names":["getUserGrade","year","dayjs","month","getUserClass","id","code","classinfo","getUserClassByCode","getUserClassByNumber","grade","type","class","classid","Math","floor","classord","toString","startsWith","getClassName","classType","title","permission","isSecretary","isDepartment","isAutidor","isInspector","isAdmin","isSystem","console","log","filter","_","i"],"mappings":"qBAUO,SAASA,EAAaC,GAE3B,OADUC,IAAQD,OACPA,GAAQC,IAAQC,QAAU,EAAI,EAAI,EAC/C,CAEO,SAASC,EAAaC,EAAYC,GACvC,MAAMC,EAAYD,EAAOE,EAAmBF,GAAQG,EAAqBJ,GACnEK,EAAQV,EAAaO,EAAUN,MACrC,MAAO,CACLU,KAAMJ,EAAUI,KAChBD,QACAE,MAAOL,EAAUK,MACjBX,KAAMM,EAAUN,KAEpB,CAEO,SAASQ,EAAqBJ,GACnC,MAAMQ,EAAUC,KAAKC,MAAOV,EAAK,IAAS,KACpCM,EAAOE,EAAU,GAAK,IAAM,IAC5BG,EAAWH,EAAU,GACrBZ,EAAOa,KAAKC,MAAMV,EAAK,KAE7B,MAAO,CACLM,OACAV,OACAS,MAJYV,EAAaC,GAKzBW,MAAOI,EAEX,CAEO,SAASR,EAAmBF,GACjC,MAAML,EAAOa,KAAKC,MAAOT,EAAO,IAAW,KAAS,IAC9CI,EAAQV,EAAaC,GACrBY,EAAUC,KAAKC,MAAOT,EAAO,IAAS,KAC5C,OAAIA,EAAKW,SAAS,GAAGC,WAAW,MACvB,CACLP,KAAME,GAAW,EAAI,IAAM,IAC3BZ,OACAS,QACAE,MAAOC,GAAW,EAAIA,EAAUA,EAAU,GAEnCP,EAAKW,SAAS,GAAGC,WAAW,MAC9B,CACLP,KAAME,GAAW,EAAI,IAAM,IAC3BZ,OACAS,QACAE,MAAOC,GAAW,EAAIA,EAAUA,EAAU,GAGrC,CACLF,KAAM,IACNV,OACAS,MAAO,EACPE,MAAOC,EAGb,CAEO,SAASM,EAAaC,GAC3B,MAAMC,EAA2B,MAAnBD,EAAUT,KAAe,IAAM,IAE7C,GAAwB,IAApBS,EAAUV,MAAa,MAAO,OAClC,GAAwB,IAApBU,EAAUR,MAAa,MAAO,GAACQ,EAAAnB,SACA,GAAAmB,EAAAV,MAAA,EACA,MAAA,GAAAU,EAAAnB,UACAmB,EAAAR,MAAA,GAAA,MAAAQ,EAAAR,MAAA,IAAA,GAAAQ,EAAAR,YAGA,MAAA,GAAAS,IARpB,CAAC,IAAK,IAAK,KAOSD,EAAAV,MAAA,MACAU,EAAAR,MAAA,MACA,gIAEA,SAAAP,EAAAC,GACA,OAAAa,EAAAf,EAAAC,EAAAC,GACA,qHCjF9B,SAAyBgB,GAW9B,MACMC,EAA2B,EAAbD,EACdE,EAA4B,EAAbF,EACfG,EAAyB,EAAbH,EACZI,EAA2B,EAAbJ,EACdK,EAAuB,GAAbL,EACVM,EAAwB,GAAbN,EAWjB,OAVAO,QAAQC,IAPU,KAShBP,EACAC,EACAC,EACAC,EACAC,EACAC,EACAN,GAEK,CAAC,UAAW,YAAa,aAAc,UAAW,YAAa,QAAS,UAAUS,QACvF,CAACC,EAAGC,IAAM,CAlBM,KAkBMV,EAAaC,EAAcC,EAAWC,EAAaC,EAASC,GAAUK,IAEhG"}